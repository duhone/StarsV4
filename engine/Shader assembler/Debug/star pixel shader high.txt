ps_1_4

texld r0,t0  //base texture
texcrd r1.rgb,t1 //view vector
texcrd r2.rgb,t2  //normal vector
texcrd r4.rgb,t4  //color

dp3_sat r1,r1_bx2,r2_bx2
mul r1.rgb,r1,r4
mul r5.rgb,r1,c2  //view lighting

add r2.rgb,r4,c3
mul r2.rgb,r0,r2
mul r2.rgb,r2,c4  //regular color

phase
texld r1,t3  //noise texture
texcrd r4.rgb,t4  //color

add r3.rgb,r4,c3
mul r3.rgb,r1,r3
mul r3.rgb,r3,c4

add r4.rgb,r2,r3
add r0.rgb,r4,r5
+mov r0.a,c1.a

;17 instructions